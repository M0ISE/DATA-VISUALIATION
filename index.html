<!DOCTYPE html>
<html lang="en">

<head>
	<meta charset="utf-8">
	<title>A3-DATA-VISUALIATION</title>
	<script src="https://d3js.org/d3.v5.js"></script>
	<script href="code.js"></script>
	<link rel="stylesheet" href="design.css">

	<link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css">

	<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js" integrity="sha384-JjSmVgyd0p3pXB1rRibZUAYoIIy6OrQ6VrjIEaFf/nJGzIxFDsf4x0xIM+B07jRM" crossorigin="anonymous"></script>


	<link href="https://fonts.googleapis.com/css?family=IBM+Plex+Mono:400,400i|IBM+Plex+Sans+Condensed:400,400i|IBM+Plex+Sans:100,100i,400,400i,700,700i|IBM+Plex+Serif:400,400i&display=swap" rel="stylesheet">

</head>

<body>

	<h1>A3-DATA-VISUALIATION</h1>

	<div id="chart">
		<div id="Compare">Compare</div>
		<div id="Isolate">Isolate</div>

		<div id="tooltip" class="hidden">
			<p id="toolTipTitle"><strong>Tooltip</strong></p>
			<p>$<span id="value">100</span></p>
		</div>
	</div>

	<div id="TheButtons">

	</div>

	<div style="background-color: #fff0fe; padding: 10px; border-radius: 10px;">
		<h3>Run These:</h3>
		<ol>
			<li><code>cd /Users/Yourname/Desktop/D3files</code></li>
			<li><code>python -m SimpleHTTPServer 8888</code></li>
			<li><code>http://localhost:8888/</code></li>
		</ol>
	</div>

	<script>
		// ---- DATA -------------------------------------------------------

		// 1. Import the data
		// Instructions for reading in data: http://learnjsdata.com/read_data.html

		d3.csv("data.csv", // 1.a Connect to the data
				function(d) {
					return {
						country: d.country,
						valA: +d.valA,
						valB: +d.valB,
						valC: +d.valC
					}

					// 1.b Prepare the data
				})
			.then(function(dataset) { // 1.c Do stuff with the data

				console.log(dataset);

				// ---- VARIABLES --------------------------------------------------

				// 2. Set up variables

				var w = 500;
				var h = 820;
				var padding = 60;

				// ---- SCALES AND AXES --------------------------------------------

				// 3. Create scales

				var xScale = d3.scaleBand()
					// 3.a. Set the domain to the countries
					.domain(dataset.map(
						function(d) {
							return d.country;
						}
					))
					.rangeRound([padding, w - padding])
					.paddingInner(0.05);

				var yScale = d3.scaleBand()
					// 3.b. Set the domain to the values
					.domain(dataset.map(function(d) {
						return d.country;
					}))
					.rangeRound([padding, h - padding])
					.paddingInner(0.05);

				var zScale = d3.scaleLinear()
					// 3.b. Set the domain to the values
					.domain([0, d3.max(dataset,
						function(d) {
							return d.valC
						})])
					.range([padding, w - padding]);

				// 4. Define axes.

				var xAxis = d3.axisBottom(xScale);
				var yAxis = d3.axisLeft(yScale);
				var zAxis = d3.axisBottom(zScale);

				// ---- START BUILDING! --------------------------------------------

				// 5. Create SVG and generate axes.

				// 5.a. Create SVG
				var svg = d3.select("#chart")
					.append("svg")
					.attr("width", w)
					.attr("height", h);


				// 5.b. Create Axes
				//		svg.append("g")
				//			.attr("class", "bottomAxis")
				//			.attr("transform", "translate(0," + (h - padding) + ")")
				//			.call(xAxis);

				svg.append("g")
					.attr("class", "leftAxis")
					.attr("transform", "translate(" + padding + ",0)")
					.call(yAxis);


				//.attr("class","some_other_id")


				for (var i = 0; i < d3.selectAll(dataset).size(); i++) {
					var Button = d3.select("#TheButtons")
					d3.select("#TheButtons")
						.append("button")
						.attr("type", "button")
						.attr("class", "btn-btn")
						.attr("id", function(d) {
							return 'button ' + i;
						})
						.append("div")
						.attr("class", "label")
						.text(function(d) {
							return  " ";
						})
						.selectAll('button')
						.data(dataset)
						.enter()
						.append('option')
						.text(function(d, i) {
							return d.country;
						})

				}

				d3.select("body")
					.style("background-color", "rgb(240,240,240)")

				// 6. Create bars
				var circlesOne = svg.selectAll("circles")
					.data(dataset)
					.enter()
					.append("circle")
					.attr("class", "circle")
					.attr("cy", function(d, i) {
						return yScale(d.country) + yScale.bandwidth() / 2;
					})
					.attr("cx", w / 4)
					.attr("r", function(d) {
						return 4 * Math.sqrt((d.valA) / (2 * Math.PI))
					})
					.attr("fill", function(d, i) {
						// 6.a. Set fill colour based on data.
						return "rgba(" + 1.5 * (d.valA + 100) + "," + 0 + "," + 0 + "," + 0.5 + ")"
					});

				var circlesTwo = svg.selectAll("circlesTwo")
					.data(dataset)
					.enter()
					.append("circle")
					.attr("class", "circle")
					.attr("cy", function(d, i) {
						return yScale(d.country) + yScale.bandwidth() / 2;
					})
					.attr("cx", 2 * (w / 4))
					.attr("r", function(d) {
						return 4 * Math.sqrt((d.valB) / (2 * Math.PI))
					})
					.attr("fill", function(d, i) {
						// 6.a. Set fill colour based on data.
						return "rgb(" + 0 + "," + 1.5 * (d.valB + 100) + "," + 0 + "," + 0.5 + ")"
					});

				var circlesThree = svg.selectAll("circlesThree")
					.data(dataset)
					.enter()
					.append("circle")
					.attr("class", "circle")
					.attr("cy", function(d, i) {
						return yScale(d.country) + yScale.bandwidth() / 2;
					})
					.attr("cx", 3 * (w / 4))
					.attr("r", function(d) {
						return 4 * Math.sqrt((d.valC) / (2 * Math.PI))
					})
					.attr("fill", function(d, i) {
						// 6.a. Set fill colour based on data.
						return "rgb(" + 0 + "," + 0 + "," + 1.5 * (d.valC + 100) + "," + 0.5 + ")"
					});

				// 7. Create Labels

				var labelsOne = svg.selectAll("labelsOne")
					.data(dataset)
					.enter()
					.append("text")
					.attr("class", "label")
					.text(function(d, i) {
						return d.valA
						// 7.a. Set text value
					})
					.attr("y", function(d, i) {
						return yScale(d.country) + 6 + yScale.bandwidth() / 2;
					})
					.attr("x", 1 * (w / 4))

					.attr("text-anchor", "middle")
					.attr("font-family", "IBM Plex Sans")
					.attr("font-size", "16px")
					.attr("fill", "white");

				var labelsTwo = svg.selectAll("labelsTwo")
					.data(dataset)
					.enter()
					.append("text")
					.attr("class", "label")
					.text(function(d, i) {
						return d.valB
						// 7.a. Set text value
					})
					.attr("y", function(d, i) {
						return yScale(d.country) + 6 + yScale.bandwidth() / 2;
					})
					.attr("x", 2 * (w / 4))

					.attr("text-anchor", "middle")
					.attr("font-family", "IBM Plex Sans")
					.attr("font-size", "16px")
					.attr("fill", "white");

				var labelsThree = svg.selectAll("labelsThree")
					.data(dataset)
					.enter()
					.append("text")
					.attr("class", "label")
					.text(function(d, i) {
						return d.valC
						// 7.a. Set text value
					})
					.attr("y", function(d, i) {
						return yScale(d.country) + 6 + yScale.bandwidth() / 2;
					})
					.attr("x", 3 * (w / 4))

					.attr("text-anchor", "middle")
					.attr("font-family", "IBM Plex Sans")
					.attr("font-size", "16px")
					.attr("fill", "white");

				d3.select("#Isolate").on("click", function() {
					console.log("Clicked Isolate!");

					labelsOne
						.transition()
						.duration(820)
						.ease(d3.easeBackInOut)
						.attr("fill", "white");

					labelsTwo
						.transition()
						.duration(820)
						.ease(d3.easeBackInOut)
						.attr("fill", "white");

					labelsThree
						.transition()
						.duration(820)
						.ease(d3.easeBackInOut)
						.attr("fill", "white");

					circlesOne
						.transition()
						.duration(820)
						.ease(d3.easeBackInOut)
						.attr("r", function(d) {
							return 4 * Math.sqrt((d.valA) / (2 * Math.PI))
						})
						.attr("cx", 1 * (w / 4))

					circlesTwo
						.transition()
						.duration(820)
						.ease(d3.easeBackInOut)
						.attr("r", function(d) {
							return 4 * Math.sqrt((d.valB) / (2 * Math.PI))
						})
						.attr("cx", 2 * (w / 4))

					circlesThree
						.transition()
						.duration(820)
						.ease(d3.easeBackInOut)
						.attr("r", function(d) {
							return 4 * Math.sqrt((d.valC) / (2 * Math.PI))
						})
						.attr("cx", 3 * (w / 4))

				}) // Isolate Clicked Changed

				d3.select("#Compare").on("click", function() {
					console.log("Clicked Compare!");

					labelsOne
						.transition()
						.duration(820)
						.ease(d3.easeBackInOut)
						.attr("fill", "transparent");

					labelsTwo
						.transition()
						.duration(820)
						.ease(d3.easeBackInOut)
						.attr("fill", "transparent");

					labelsThree
						.transition()
						.duration(820)
						.ease(d3.easeBackInOut)
						.attr("fill", "transparent");

					circlesOne
						.transition()
						.duration(820)
						.ease(d3.easeBackInOut)
						.attr("r", function(d) {
							return 6 * Math.sqrt((d.valA) / (2 * Math.PI))
						})
						.attr("cx", (w / 2))

					circlesTwo
						.transition()
						.duration(820)
						.ease(d3.easeBackInOut)
						.attr("r", function(d) {
							return 6 * Math.sqrt((d.valB) / (2 * Math.PI))
						})
						.attr("cx", (w / 2))

					circlesThree
						.transition()
						.duration(820)
						.ease(d3.easeBackInOut)
						.attr("r", function(d) {
							return 6 * Math.sqrt((d.valC) / (2 * Math.PI))
						})
						.attr("cx", (w / 2))

				}) // Compare Clicked Changed

				d3.select("#Australia").on("click", function() {
					console.log("Clicked Compare!");

					labelsOne
						.transition()
						.duration(820)
						.ease(d3.easeBackInOut)
						.attr("fill", "transparent");

					labelsTwo
						.transition()
						.duration(820)
						.ease(d3.easeBackInOut)
						.attr("fill", "transparent");

					labelsThree
						.transition()
						.duration(820)
						.ease(d3.easeBackInOut)
						.attr("fill", "transparent");

					circlesOne
						.transition()
						.duration(820)
						.ease(d3.easeBackInOut)
						.attr("r", function(d) {
							return 6 * Math.sqrt((d.valA) / (2 * Math.PI))
						})
						.attr("cx", (w / 2))

					circlesTwo
						.transition()
						.duration(820)
						.ease(d3.easeBackInOut)
						.attr("r", function(d) {
							return 6 * Math.sqrt((d.valB) / (2 * Math.PI))
						})
						.attr("cx", (w / 2))

					circlesThree
						.transition()
						.duration(820)
						.ease(d3.easeBackInOut)
						.attr("r", function(d) {
							return 6 * Math.sqrt((d.valC) / (2 * Math.PI))
						})
						.attr("cx", (w / 2))

				}) // Compare Clicked Changed



			});
	</script>

</body>
